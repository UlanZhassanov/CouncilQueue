<?php
  /*
    * lib/delete.php 
    * used for Removing customer in The Queue 
    * Author Ruben Faraj 
    * Email: Reben_f@hotmail.co.uk 
    * Date : 14-05-2017 
   */

   session_start();

   try {
        
   // include database connection ////////////////////////////////////////////////////////////////
   include '../config/db_connector.php';//////////////////////////////////////////////////////////
   ///////////////////////////////////////////////////////////////////////////////////////////////


       // get record ID ***************************************************************************
       // isset() is a PHP function used to verify if a value is there or not *********************
       $id=isset($_GET['id']) ? $_GET['id'] : die('ERROR: Record ID not found.'); //***************
       $window=isset($_SESSION['window']) ? $_SESSION['window'] : die('ERROR: Record Window not found.'); //***************
   //**********************************************************************************************

    
       // delete query @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       $query = "UPDATE queue_tb SET status = 2, window = :window WHERE id = :id";//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       $stmt = $con->prepare($query);//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       $stmt->bindParam("id", $id, PDO::PARAM_STR);
       $stmt->bindParam("window", $window, PDO::PARAM_STR);
       if($stmt->execute()){    //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           // redirect to index.php records page and @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           // tell the user record was deleted  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           header('Location: ../admin.php?action=takeUser');//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       }else{                               //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
           die('Unable to update record.');//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       }//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   }//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    
   // show error &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
   catch(PDOException $exception){ //&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
       die('ERROR: ' . $exception->getMessage());//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
   }//End catch &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

?>